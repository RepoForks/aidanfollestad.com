<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Capture and Playback Tests</title>

    <!-- VideoJS.Record and Related Plugins -->
    <script src="/videojs-record/videojs.record.min.js"></script>
    <script src="/videojs-record/videojs.wavesurfer.js"></script>
    <link href="/videojs-record/css/videojs.record.min.css" rel="stylesheet">

    <!-- Video.js -->
    <link href="//vjs.zencdn.net/5.8/video-js.min.css" rel="stylesheet">
    <script src="//vjs.zencdn.net/5.8/video.min.js"></script>

    <!-- WaveSurfer -->
    <script src="//cdnjs.cloudflare.com/ajax/libs/wavesurfer.js/1.0.52/wavesurfer.min.js"></script>
    <script src="//collab-project.github.io/videojs-wavesurfer/dist/wavesurfer.microphone.min.js"/>

    <!-- RecordRTC -->
    <script src="//cdn.webrtc-experiment.com/RecordRTC.js"></script>

    <!-- jQuery -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>

    <!-- Materialize -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/css/materialize.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.7/js/materialize.min.js"></script>

    <!-- Internal -->
    <link href="/videojs-record/css/captureandplay.css" rel="stylesheet">

</head>
<body>

<nav>
    <div class="nav-wrapper blue">
        <a href="#" class="brand-logo">Capture and Playback Tests</a>
    </div>
</nav>

<div id="body-content">

    <h3>Video Capture</h3>

    <video id="myVideo" class="video-js vjs-default-skin"></video>

    <h3>Audio Capture</h3>

    <audio id="myAudio" class="video-js vjs-default-skin"></audio>

</div>

<!-- SETUP VIDEO CAPTURE -->
<script>
    var videoPlayer = videojs("myVideo",
            {
                controls: true,
                width: 320,
                height: 240,
                plugins: {
                    record: {
                        audio: true,
                        video: true,
                        maxLength: 10,
                        debug: true
                    }
                }
            });

    // error handling
    videoPlayer.on('deviceError', function () {
        console.log('device error:', videoPlayer.deviceErrorCode);
    });
    videoPlayer.on('error', function (error) {
        console.log('error:', error);
    });

    // user clicked the record button and started recording
    videoPlayer.on('startRecord', function () {
        console.log('started recording!');
    });

    // user completed recording and stream is available
    videoPlayer.on('finishRecord', function () {
        // the blob object contains the recorded data that
        // can be downloaded by the user, stored on server etc.
        console.log('finished recording: ', videoPlayer.recordedData);
    });
</script>

<!-- SETUP AUDIO-ONLY CAPTURE -->
<script>
    var audioPlayer = videojs("myAudio",
            {
                controls: true,
                width: 600,
                height: 300,
                plugins: {
                    wavesurfer: {
                        src: "live",
                        waveColor: "black",
                        progressColor: "#2E732D",
                        cursorWidth: 1,
                        msDisplayMax: 20,
                        hideScrollbar: true
                    },
                    record: {
                        audio: true,
                        video: false,
                        maxLength: 20,
                        debug: true
                    }
                }
            });
    // error handling
    audioPlayer.on('deviceError', function () {
        console.log('device error:', audioPlayer.deviceErrorCode);
    });

    // user clicked the record button and started recording
    audioPlayer.on('startRecord', function () {
        console.log('started recording!');
    });

    // user completed recording and stream is available
    audioPlayer.on('finishRecord', function () {
        // the blob object contains the recorded data that
        // can be downloaded by the user, stored on server etc.
        console.log('finished recording: ', audioPlayer.recordedData);
    });
</script>

</body>
</html>